// RUN: xcore-opt --mlir-io %s --xcore-apply-xcpatterns | FileCheck %s

// CHECK-LABEL: relu_1
func.func @relu_1(%arg0: tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0x828486888A8C8E90929496989A9C9EA0A2A4A6A8AAACAEB0B2B4B6B8BABCBEC0C2C4C6C8CACCCED0D2D4D6D8DADCDEE0E2E4E6E8EAECEEF0F2F4F6F8FAFCFE00020406080A0C0E10121416181A1C1E20222426282A2C2E30323436383A3C3E40424446484A4C4E50525456585A5C5E60626466686A6C6E70727476787A7C7E7F8080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.relu"(%arg0) : (tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
  return %0 : tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
}

// -----

// CHECK-LABEL: relu_2
func.func @relu_2(%arg0: tensor<1x12x2x4x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x2x4x!quant.uniform<i8:f32, 0.0039192917756736279:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0x828486888A8C8E90929496989A9C9EA0A2A4A6A8AAACAEB0B2B4B6B8BABCBEC0C2C4C6C8CACCCED0D2D4D6D8DADCDEE0E2E4E6E8EAECEEF0F2F4F6F8FAFCFE00020406080A0C0E10121416181A1C1E20222426282A2C2E30323436383A3C3E40424446484A4C4E50525456585A5C5E60626466686A6C6E70727476787A7C7E7F8080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.relu"(%arg0) : (tensor<1x12x2x4x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x2x4x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
  return %0 : tensor<1x12x2x4x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
}

// -----

// CHECK-LABEL: relu6_1
func.func @relu6_1(%arg0: tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0x828486888A8C8E90929496989A9C9EA0A2A4A6A8AAACAEB0B2B4B6B8BABCBEC0C2C4C6C8CACCCED0D2D4D6D8DADCDEE0E2E4E6E8EAECEEF0F2F4F6F8FAFCFE00020406080A0C0E10121416181A1C1E20222426282A2C2E30323436383A3C3E40424446484A4C4E50525456585A5C5E60626466686A6C6E70727476787A7C7E7F8080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.relu6"(%arg0) : (tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
  return %0 : tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
}

// -----

// CHECK-LABEL: relu6_2
func.func @relu6_2(%arg0: tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0x828486888A8C8E90929496989A9C9EA0A2A4A6A8AAACAEB0B2B4B6B8BABCBEC0C2C4C6C8CACCCED0D2D4D6D8DADCDEE0E2E4E6E8EAECEEF0F2F4F6F8FAFCFE00020406080A0C0E10121416181A1C1E20222426282A2C2E30323436383A3C3E40424446484A4C4E50525456585A5C5E60626466686A6C6E70727476787A7C7E7F8080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.relu6"(%arg0) : (tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
  return %0 : tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
}

// -----

// CHECK-LABEL: tanh_1
func.func @tanh_1(%arg0: tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0x828486888A8C8E90929496989A9C9EA0A2A4A6A8AAACAEAFB1B3B5B7B9BBBDBFC1C2C4C6C8CACCCDCFD1D3D5D6D8DADCDDDFE1E3E4E6E8E9EBEDEEF0F1F3F5F6F8F9FBFCFEFF0102040507080A0B0C0E0F111213151617191A1B1C1E1F2021222425262728292A2C2D2E2F303132333435363738393A3B3C3D3D3E3F404142438080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.tanh"(%arg0) : (tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
  return %0 : tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
}

// -----

// CHECK-LABEL: tanh_2
func.func @tanh_2(%arg0: tensor<1x5x2x2x!quant.uniform<i8:f32, 0.0313539207:-1>>) -> tensor<1x5x2x2x!quant.uniform<i8:f32, 0.007838583551:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0x84888C9094989C9FA3A7AAAEB1B5B8BBBEC1C4C7CACCCFD1D4D6D8DADCDEE0E1E3E5E6E7E9EAEBECEDEEEFF0F1F2F3F4F4F5F6F6F7F7F8F8F9F9F9FAFAFAFBFBFBFCFCFCFCFCFDFDFDFDFDFDFEFEFEFEFEFEFEFEFEFEFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.tanh"(%arg0) : (tensor<1x5x2x2x!quant.uniform<i8:f32, 0.0313539207:-1>>) -> tensor<1x5x2x2x!quant.uniform<i8:f32, 0.007838583551:-128>>
  return %0 : tensor<1x5x2x2x!quant.uniform<i8:f32, 0.007838583551:-128>>
}

// -----

// CHECK-LABEL: logistic_1
func.func @logistic_1(%arg0: tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0x000101020203030404050506060707080809090A0A0B0B0C0C0D0D0E0E0F0F0F10101111121213131414151516161717181819191A1A1B1B1C1C1D1D1E1E1E1F1F202021212222232324242425252626272728282929292A2A2B2B2C2C2D2D2D2E2E2F2F3030303131323233333334343535353636373738383839393A3A3A3BC5C5C6C6C6C7C7C8C8C8C9C9CACACBCBCBCCCCCDCDCDCECECFCFD0D0D0D1D1D2D2D3D3D3D4D4D5D5D6D6D7D7D7D8D8D9D9DADADBDBDCDCDDDDDDDEDEDFDFE0E0E1E1E2E2E3E3E4E4E4E5E5E6E6E7E7E8E8E9E9EAEAEBEBECECEDEDEEEEEFEFF0F0F1F1F2F2F3F3F4F4F5F5F6F6F7F7F8F8F9F9FAFAFBFBFCFCFDFDFEFEFFFF00"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.logistic"(%arg0) : (tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0078384801745414734:-1>>) -> tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
  return %0 : tensor<1x12x4x7x!quant.uniform<i8:f32, 0.0039192917756736279:-128>>
}

// -----

// CHECK-LABEL: logistic_2
func.func @logistic_2(%arg0: tensor<1x4x4x4x!quant.uniform<i8:f32, 0.0313539207:-1>>) -> tensor<1x4x4x4x!quant.uniform<i8:f32, 0.007838583551:-128>> attributes {tf.entry_function = {inputs = "lambda_input_int8", outputs = "Identity_int8"}} {
  // CHECK: "0xC1C2C3C4C5C6C7C8C9CACBCCCDCECFCFD0D1D2D3D4D5D6D7D8D8D9DADBDCDDDDDEDFE0E0E1E2E3E3E4E5E5E6E7E7E8E8E9EAEAEBEBECECEDEDEEEEEFEFF0F0F0F1F1F2F2F2F3F3F3F4F4F4F5F5F5F6F6F6F7F7F7F7F8F8F8F8F8F9F9F9F9F9FAFAFAFAFAFAFBFBFBFBFBFBFBFCFCFCFCFCFCFCFCFCFCFDFDFDFDFDFDFDFDFDFD82828283838383838383838383838484848484848484858585858585858686868686878787878788888888898989898A8A8A8A8B8B8B8C8C8C8D8D8E8E8E8F8F909090919192929393949495959697979898999A9A9B9C9C9D9E9E9FA0A1A1A2A3A4A5A5A6A7A8A9AAABACACADAEAFB0B1B2B3B4B5B6B7B8B9BABBBCBDBEBFC0"
  // CHECK-SAME: tensor<256xui8>
  // CHECK: xc.lookup
  %0 = "tfl.logistic"(%arg0) : (tensor<1x4x4x4x!quant.uniform<i8:f32, 0.0313539207:-1>>) -> tensor<1x4x4x4x!quant.uniform<i8:f32, 0.007838583551:-128>>
  return %0 : tensor<1x4x4x4x!quant.uniform<i8:f32, 0.007838583551:-128>>
}

// -----

// CHECK-LABEL: tanh_i16_1
func.func @tanh_i16_1(%arg0: tensor<1x96x!quant.uniform<i16:f32, 1.9448930106591433E-4>> {tf_saved_model.index_path = ["conv2d_input"]}) -> (tensor<1x96x!quant.uniform<i16:f32, 3.0517578125E-5>> {tf_saved_model.index_path = ["conv2d"]}) attributes {tf.entry_function = {inputs = "serving_default_conv2d_input:0", outputs = "StatefulPartitionedCall:0"}, tf_saved_model.exported_names = ["serving_default"]} {
  // CHECK: "0x02B6008000000000E9C10080000000006DD000800000000026E2008000000000C9F70080000000002F120180000000006632018000000000B659018000000000AE8901800000000039C4018000000000B00B028000000000E1620280000000004ACD028000000000234F0380000000009CED03800000000002AF0480000000000A9B05800000010001BB068000000100761A0880000001005BC7098000000100BBD20B800000010066510E8000000100BE5C118000000200C5131580000002002B9C1980000003001C241F8000000300C2E3258000000400A81F2E80000005005A2B388000000600B56C448000000700E35F5380000008001B9C658000000A008BD97B8001000C006AF8968001000F008609B880010012008758E080010016005578118101001B00E5514D8102002100EB35968102002800A7F1EE8102003100A5E75A8203003B00412CDE8204004800C8A67D8304005800FC363F8405006B0091DE29850600810054EE458607009C00A5349D870900BC00B12A3B890A00E300FD1B2D8B0C0011016640828D0F004601BEBF4B9011008501AA919C931300CE01D92889971600210229D8269C19007F0282DD8AA11B00E702A204C9A71D00590367DCF1AE1F00D1038A8C10B71F004E04EF7328C01E00C904EED732CA1C003F05D0091DD51800A8059B78C7E01300FE05341806ED0C003B06EF59A2F904005B0644A55E06FC005B060FE7FA12F4003B06C586391FED00FE05B6F5E32AE800A805C227CE35E4003F05EA8BD83FE200C9047273F048E1004E04B2230F51E100D1038CFB3758E3005903B922765EE500E7021A28DA63E7007F026CD77768EA002102996E646CED00CE018140B56FEF008501D4BF7E72F100460137E4D374F40011017CD5C576F600E30083CB6378F700BC00CE11BB79F9009C008C21D77AFA0081001CC9C17BFB006B004D59837CFC005800D0D3227DFC0048006918A67DFD003B00640E127EFE0031001FCA6A7EFE00280023AEB37EFE002100B187EF7EFF001B007FA7207FFF0016007EF6487FFF0012009A076A7FFF000F007826857FFF000C00E7639B7F00000A001FA0AD7F000008004D93BC7F00000700A7D4C87F0000060059E0D27F000005003F1CDB7F00000400E5DBE17F00000300D663E77F000003003BECEB7F0000020042A3EF7F000002009AAEF27F00000100462DF57F00000100A538F77F000001008AE5F87F00000100FF44FA7F00000100F664FB7F00000100FE50FC7F000000006412FD7F00000000DDB0FD7F00000000B632FE7F000000001F9DFE7F0000000050F4FE7F00000000C73BFF7F000000005276FF7F000000004AA6FF7F000000009ACDFF7F00000000D1EDFF7F00000000FFFFFF7F00000000FFFFFF7F00000000FFFFFF7F00000000FFFFFF7F00000000FFFFFF7F00000000"
  // CHECK-SAME: tensor<1024xui8>
  // CHECK: xc.lookup
  %0 = "tfl.tanh"(%arg0) : (tensor<1x96x!quant.uniform<i16:f32, 1.9448930106591433E-4>>) -> tensor<1x96x!quant.uniform<i16:f32, 3.0517578125E-5>>
  return %0 : tensor<1x96x!quant.uniform<i16:f32, 3.0517578125E-5>>
}

// -----

// CHECK-LABEL: tanh_i16_2
func.func @tanh_i16_2(%arg0: tensor<1x129x!quant.uniform<i16:f32, 1.9448930106591433E-4>> {tf_saved_model.index_path = ["conv2d_input"]}) -> (tensor<1x129x!quant.uniform<i16:f32, 3.0517578125E-5>> {tf_saved_model.index_path = ["conv2d"]}) attributes {tf.entry_function = {inputs = "serving_default_conv2d_input:0", outputs = "StatefulPartitionedCall:0"}, tf_saved_model.exported_names = ["serving_default"]} {
  // CHECK: "0x02B6008000000000E9C10080000000006DD000800000000026E2008000000000C9F70080000000002F120180000000006632018000000000B659018000000000AE8901800000000039C4018000000000B00B028000000000E1620280000000004ACD028000000000234F0380000000009CED03800000000002AF0480000000000A9B05800000010001BB068000000100761A0880000001005BC7098000000100BBD20B800000010066510E8000000100BE5C118000000200C5131580000002002B9C1980000003001C241F8000000300C2E3258000000400A81F2E80000005005A2B388000000600B56C448000000700E35F5380000008001B9C658000000A008BD97B8001000C006AF8968001000F008609B880010012008758E080010016005578118101001B00E5514D8102002100EB35968102002800A7F1EE8102003100A5E75A8203003B00412CDE8204004800C8A67D8304005800FC363F8405006B0091DE29850600810054EE458607009C00A5349D870900BC00B12A3B890A00E300FD1B2D8B0C0011016640828D0F004601BEBF4B9011008501AA919C931300CE01D92889971600210229D8269C19007F0282DD8AA11B00E702A204C9A71D00590367DCF1AE1F00D1038A8C10B71F004E04EF7328C01E00C904EED732CA1C003F05D0091DD51800A8059B78C7E01300FE05341806ED0C003B06EF59A2F904005B0644A55E06FC005B060FE7FA12F4003B06C586391FED00FE05B6F5E32AE800A805C227CE35E4003F05EA8BD83FE200C9047273F048E1004E04B2230F51E100D1038CFB3758E3005903B922765EE500E7021A28DA63E7007F026CD77768EA002102996E646CED00CE018140B56FEF008501D4BF7E72F100460137E4D374F40011017CD5C576F600E30083CB6378F700BC00CE11BB79F9009C008C21D77AFA0081001CC9C17BFB006B004D59837CFC005800D0D3227DFC0048006918A67DFD003B00640E127EFE0031001FCA6A7EFE00280023AEB37EFE002100B187EF7EFF001B007FA7207FFF0016007EF6487FFF0012009A076A7FFF000F007826857FFF000C00E7639B7F00000A001FA0AD7F000008004D93BC7F00000700A7D4C87F0000060059E0D27F000005003F1CDB7F00000400E5DBE17F00000300D663E77F000003003BECEB7F0000020042A3EF7F000002009AAEF27F00000100462DF57F00000100A538F77F000001008AE5F87F00000100FF44FA7F00000100F664FB7F00000100FE50FC7F000000006412FD7F00000000DDB0FD7F00000000B632FE7F000000001F9DFE7F0000000050F4FE7F00000000C73BFF7F000000005276FF7F000000004AA6FF7F000000009ACDFF7F00000000D1EDFF7F00000000FFFFFF7F00000000FFFFFF7F00000000FFFFFF7F00000000FFFFFF7F00000000FFFFFF7F00000000"
  // CHECK-SAME: tensor<1024xui8>
  // CHECK: xc.lookup
  %0 = "tfl.tanh"(%arg0) : (tensor<1x129x!quant.uniform<i16:f32, 1.9448930106591433E-4>>) -> tensor<1x129x!quant.uniform<i16:f32, 3.0517578125E-5>>
  return %0 : tensor<1x129x!quant.uniform<i16:f32, 3.0517578125E-5>>
}

// -----

// CHECK-LABEL: sigmoid_i16_1
func.func @sigmoid_i16_1(%arg0: tensor<1x96x!quant.uniform<i16:f32, 1.9448930106591433E-4>> {tf_saved_model.index_path = ["conv2d_input"]}) -> (tensor<1x96x!quant.uniform<i16:f32, 3.0517578125E-5>> {tf_saved_model.index_path = ["conv2d"]}) attributes {tf.entry_function = {inputs = "serving_default_conv2d_input:0", outputs = "StatefulPartitionedCall:0"}, tf_saved_model.exported_names = ["serving_default"]} {
  // CHECK: "0x482F3B00000003003051410000000300C91648000000040011914F0000000400C3D257000000040088F060000000050026016B0000000500B51D760000000600DA618200000006000CEC8F0000000700D4DD9E00000008001E5CAF00000009008A8FC10000000A00C8A4D50000000B00F9CCEB0000000C001A3E040100000D0077331F0100000E0024EE3C010000100084B55D0100001100D4D7810100001300C0AAA90101001500068CD5010100170019E2050201001900D11C3B0201001C0020B6750201001F00CC32B602010022002A23FD0201002500DC234B030100290085DEA00301002D007E0AFF0301003100726D660401003600EFDBD70401003B00D239540501004100927ADC050200470054A1710602004E00C2C014070200550096FAC60702005D00C57E890802006600358A5D0902006F00F764440A03007800E65F3F0B030083009BD14F0C03008E00A112770D03009A00E578B60E0300A60038520F100300B3000EDE82110300C100394612130400CF00ED96BE140400DE0001B688160400ED00925971180400FC0051FE781A04000C01C1DD9F1C04001B01A1E4E51E04002B0130AA4A2104003A015568CD2304004901A5F56C26030057015BC1272903006401D5D1FB2B030070011DC6E62E03007B016EDAE5310200840148F0F53402008C016C9913380100920126263B3B01009601E3B5683E000098010E4A984100009801D3D9C544FF0096018A66ED47FF009201AD0F0B4BFE008C0185251B4EFE008401DF391A51FD007B01202E0554FD007001A33ED956FD006401580A9459FD005701AB97335CFC004901D455B65EFC003A015B1B1B61FC002B013D226163FC001B01B1018865FC000C0170A68F67FC00FC00024A7869FC00ED001169426BFC00DE00C8B9EE6CFC00CF00F5217E6EFD00C100CAADF16FFD00B30021874A71FD00A60061ED8972FD009A006D2EB173FD008E001CA0C174FD0083000C9BBC75FD007800D375A376FE006F003E817777FE0066006B053A78FE005D00403FEC78FE005500AE5E8F79FE004E006E85247AFE00470032C6AC7AFF0041001424297BFF003B0091929A7BFF00360084F5017CFF0031008021607CFF002D0026DCB57CFF002900D7DC037DFF00250033CD4A7DFF002200E2498B7DFF001F0030E3C57DFF001C00E91DFB7DFF00190002742B7EFF0017004055577EFF0015002F287F7E000013007D4AA37E00001100D811C47E0000100086CCE17E00000E00E1C1FC7E00000D000933157F00000C00365B2B7F00000B0078703F7F00000A00E2A3517F000009002D22627F00000800FA13717F00000700269E7E7F000006004AE28A7F00000600DAFE957F00000500750FA07F000005003A2DA97F00000400F26EB17F0000040036E9B87F00000400CEAEBF7F00000300B7D0C57F00000300"
  // CHECK-SAME: tensor<1024xui8>
  // CHECK: xc.lookup
  %0 = "tfl.logistic"(%arg0) : (tensor<1x96x!quant.uniform<i16:f32, 1.9448930106591433E-4>>) -> tensor<1x96x!quant.uniform<i16:f32, 3.0517578125E-5>>
  return %0 : tensor<1x96x!quant.uniform<i16:f32, 3.0517578125E-5>>
}